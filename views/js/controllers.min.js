define("taoOutcomeUi/controller/routes",[],function(){"use strict";return{Results:{actions:{viewResult:"controller/viewResult",index:"controller/inspectResults"}},ResultTable:{actions:{index:"controller/resultTable"}}}}),define("taoOutcomeUi/controller/inspectResults",["jquery","i18n","module","helpers","layout/actions/binder","uri","ui/feedback","util/encode","ui/datatable","jquery.fileDownload"],function($,__,module,helpers,binder,uri,feedback,encode){"use strict";function loadResults($container,model,classUri){var params={classUri:classUri};$(".inspect-results-grid",$container).empty().data("ui.datatable",null).datatable({url:helpers._url("getResults","Results","taoOutcomeUi",params),
model:model,actions:{view:function(id){var action={binding:"load",url:helpers._url("viewResult","Results","taoOutcomeUi")};binder.exec(action,{id:id,classUri:uri.decode(classUri)}||this._resourceContext)},"delete":function(id){var confirmBox=$(".preview-modal-feedback"),cancel=confirmBox.find(".cancel"),save=confirmBox.find(".save");confirmBox.find(".modal-close");confirmBox.modal({width:500}),save.off("click").on("click",function(){$.ajax({url:helpers._url("delete","Results","taoOutcomeUi"),type:"POST",data:{uri:uri.encode(id)},dataType:"json",success:function(response){response.deleted?(feedback().success(__("Result has been deleted")),loadResults($container,model,classUri)):feedback().error(__("Something went wrong ...")+"<br>"+encode.html(response.error),{
encodeHtml:!1})}}),confirmBox.modal("close")}),cancel.off("click").on("click",function(){confirmBox.modal("close")})},download:function(id){$.fileDownload(helpers._url("downloadXML","Results","taoOutcomeUi"),{preparingMessageHtml:__("We are preparing your report, please wait..."),failMessageHtml:__("There was a problem generating your report, please try again."),httpMethod:"GET",data:{deliveryExecution:id}})}}})}var inspectResultController={start:function(){var $container=$("#inspect-result");loadResults($container,$container.data("model"),$container.data("uri")),binder.register("download_csv",function(item){$.fileDownload(this.url,{httpMethod:"GET",data:{uri:item.uri
}})})}};return inspectResultController}),define("taoOutcomeUi/controller/resultTable",["jquery","lodash","i18n","helpers","module","ui/datatable","jquery.fileDownload"],function($,_,__,helpers,module){"use strict";var resulTableController={start:function(){var conf=module.config(),$container=$(".result-table"),$filterField=$(".result-filter",$container),$tableContainer=$(".result-table-container",$container),filter=conf.filter||"lastSubmitted",uri=conf.uri||"",columns=[],groups={},buildGrid=function(url,action,done){$.ajax({url:url,dataType:"json",data:{filter:filter,uri:uri},type:"GET"}).done(function(response){response&&response.columns&&(columns="remove"===action?_.reject(columns,function(col){
return _.find(response.columns,function(resCol){return _.isEqual(col,resCol)})}):void 0!==response.first&&response.first===!0?response.columns.concat(columns):columns.concat(response.columns),_buildTable(done))})},_buildTable=function(done){var model=[];_.forEach(columns,function(col){model.push({id:col.prop||col.contextId+"_"+col.variableIdentifier,label:col.label,sortable:!1})}),$tableContainer.empty().data("ui.datatable",null).off("load.datatable").on("load.datatable",function(){$(".result-export",$container).off("click").removeClass("disabled").on("click",function(e){e.preventDefault(),$.fileDownload(helpers._url("getCsvFile","ResultTable","taoOutcomeUi"),{
preparingMessageHtml:__("We are preparing your report, please wait..."),failMessageHtml:__("There was a problem generating your report, please try again."),httpMethod:"POST",data:{filter:filter,columns:columns,uri:uri}})}),_.isFunction(done)&&(done(),done="")}).datatable({url:helpers._url("data","ResultTable","taoOutcomeUi",{filterData:filter}),querytype:"POST",params:{columns:columns,_search:!1,uri:uri},model:model})};$("[data-group]",$container).each(function(){var $elt=$(this),group=$elt.data("group"),action=$elt.data("action");groups[group]=groups[group]||{},groups[group][action]=$elt}),$container.on("click","[data-group]",function(e){e.preventDefault();var $elt=$(this),group=$elt.data("group"),action=$elt.data("action"),url=$elt.data("url");
buildGrid(url,action,function(){_.forEach(groups[group],function($btn){$btn.toggleClass("hidden")})})}),buildGrid(helpers._url("getResultOfSubjectColumn","ResultTable","taoOutcomeUi",{filter:filter})),$filterField.select2({minimumResultsForSearch:-1}).select2("val",filter),$(".result-filter-btn",$container).click(function(e){filter=$filterField.select2("val"),_buildTable()})}};return resulTableController}),define("json!taoItems/preview/resources/device-list.json",function(){return{tablets:{"193986c3715c81838870f908fa98d69a":{label:"Amazon Kindle Fire HDX 7″",width:960,height:600},"4e8eafab11aad1486992d7ee2c8c16ca":{label:"Apple iPad",width:1024,height:768},"5aac2932d9ad00d6d8a1604b8f9e4e8d":{
label:"Google Nexus 10, Motorola Xoom, Xyboard",width:1280,height:800},"9805d9753ad08c7630a9ee5418aa6c6c":{label:"Google Nexus 7",width:966,height:604},d4a431cedf4705d6bf2cba6d5788378b:{label:"Samsung Galaxy Tab 7.7, 8.9, 10.1",width:1280,height:800}},phones:{"1b89338531ef0155c8d6abc2ac02c81a":{label:"Apple iPhone 3GS",width:320,height:480,scaleFactor:1,dpWidth:320,dpHeight:480},"3f89da99d84214cde7df87ebe0699a6f":{label:"Apple iPhone 4",width:640,height:960,scaleFactor:2,dpWidth:320,dpHeight:1920},"0d36971a5b98b367f54ced708c9af849":{label:"Apple iPhone 5",width:640,height:1136,scaleFactor:2,dpWidth:320,dpHeight:2272},"026beffcc051af995660ebdede986ace":{label:"BlackBerry Z10",
width:768,height:1280,scaleFactor:2,dpWidth:384,dpHeight:2560},fd2dd53e667d6d49e4fa73356fa941dd:{label:"BlackBerry Z30",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"707584c1ae17d9b5b2cbe8603c91c147":{label:"Google Nexus 4",width:768,height:1280,scaleFactor:2,dpWidth:384,dpHeight:2560},"91823264de952e7f2347e07db5c4058b":{label:"Google Nexus 5",width:1080,height:1920,scaleFactor:3,dpWidth:360,dpHeight:5760},cd69817a6e147e8a4677389e56fcf568:{label:"Google Nexus S",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"75994faa6a38e31e99b53fcd75534a33":{label:"HTC Evo, Touch HD, Desire HD, Desire",width:480,height:800,scaleFactor:1.5,
dpWidth:320,dpHeight:1200},"0cab4dfccdfc880687cb608cfe4159db":{label:"HTC One X, EVO LTE",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},c4ff41fcba24d74fc21dc3490ca1edc9:{label:"HTC Sensation, Evo 3D",width:540,height:960,scaleFactor:1.5,dpWidth:360,dpHeight:1440},fa969a5e0dd2de53700eeee4ba4ba142:{label:"LG Optimus 2X, Optimus 3D, Optimus Black",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"33c4f9364e295ec03531f3a3425819cf":{label:"LG Optimus G",width:768,height:1280,scaleFactor:2,dpWidth:384,dpHeight:2560},bc47f5275f0efd56fee52d43a8082981:{label:"LG Optimus LTE, Optimus 4X HD",width:720,height:1280,scaleFactor:1.7,dpWidth:424,
dpHeight:2176},"0732887e6e324fd10777b735520a34cf":{label:"LG Optimus One",width:320,height:480,scaleFactor:1.5,dpWidth:213,dpHeight:720},"2e38a78364f09d0da0e9e1a3a68e7fb0":{label:"Motorola Defy, Droid, Droid X, Milestone",width:480,height:854,scaleFactor:1.5,dpWidth:320,dpHeight:1281},bd4b78dddc7c9625a4141a1b1ddabb87:{label:"Motorola Droid 3, Droid 4, Droid Razr, Atrix 4G, Atrix 2",width:540,height:960,scaleFactor:1,dpWidth:540,dpHeight:960},"3bf1edf21cfa81006183d2b02974c84e":{label:"Motorola Droid Razr HD",width:720,height:1280,scaleFactor:1,dpWidth:720,dpHeight:1280},ab5a352e0e016b97dac986f06c394f55:{label:"Nokia C5, C6, C7, N97, N8, X7",width:360,height:640,
scaleFactor:1,dpWidth:360,dpHeight:640},"4826fb7d7257aeaac992ce699df41b3c":{label:"Nokia Lumia 7X0, Lumia 8XX, Lumia 900, N800, N810, N900",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"0a691ab20add7c432200f8fa6527b488":{label:"Samsung Galaxy Note",width:800,height:1280,scaleFactor:2,dpWidth:400,dpHeight:2560},"9c23ee31be29960fbac9e9bbfc2fc7b0":{label:"Samsung Galaxy Note 3",width:1080,height:1920,scaleFactor:2,dpWidth:540,dpHeight:3840},"92177c0508c1d73905a58e2338f2a81f":{label:"Samsung Galaxy Note II",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"5222b8866dc4cc606725e16ffcc0a783":{label:"Samsung Galaxy S III, Galaxy Nexus",
width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"37c1541e2bd55cfd0f4073b0ccdf68b3":{label:"Samsung Galaxy S, S II, W",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"2f7f64b7dda0144907ff300e83eed465":{label:"Samsung Galaxy S4",width:1080,height:1920,scaleFactor:3,dpWidth:360,dpHeight:5760},"9c24f9057744dad56043702a9703127f":{label:"Sony Xperia S, Ion",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"0a8b2732a016a9395c3af5f12dd9c0da":{label:"Sony Xperia Sola, U",width:480,height:854,scaleFactor:1,dpWidth:480,dpHeight:854},"5a153d7f53d82dcb0801f041574a6a43":{label:"Sony Xperia Z, Z1",width:1080,height:1920,scaleFactor:3,
dpWidth:360,dpHeight:5760}},screens:{"9e523ae15b61dc766f5c818726881ecf":{label:"1920 × 1080",width:1920,height:1080,dpWidth:1920,dpHeight:1080,scaleFactor:1},"07769cd8d0a7d09818b2f0b018042fb7":{label:"1366 × 768",width:1366,height:768,dpWidth:1366,dpHeight:768,scaleFactor:1},"72d5478a24194f98b9378e8e0fd65737":{label:"1280 × 1024",width:1280,height:1024,dpWidth:1280,dpHeight:1024,scaleFactor:1},b7a6dd5900cc72e61f0d3479c7e314ec:{label:"1280 × 800",width:1280,height:800,dpWidth:1280,dpHeight:800,scaleFactor:1},"43193b0ff671a37d8232ab664190a125":{label:"1024 × 768",width:1024,height:768,dpWidth:1024,dpHeight:768,scaleFactor:1},c29e48814af5443ff5688d9e967ce917:{label:"800 × 600",
width:800,height:600,dpWidth:800,dpHeight:600,scaleFactor:1}}}}),define("tpl!taoItems/preview/tpl/preview",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n                        <option value="',(helper=helpers.value)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.value,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" ',stack1=helpers["if"].call(depth0,depth0&&depth0.selected,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data
}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</option>\n                        "}function program2(depth0,data){return'selected="selected"'}function program4(depth0,data){var stack1,buffer="";return buffer+='\n                    <select class="preview-theme-selector">\n                        ',stack1=helpers.each.call(depth0,depth0&&depth0.themes,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),
buffer+="\n                    </select>\n                    "}function program6(depth0,data){var stack1,helper,buffer="";return buffer+='\n                        <option value="',(helper=helpers.value)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.value,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" data-value="',(helper=helpers.dataValue)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.dataValue,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" ',stack1=helpers["if"].call(depth0,depth0&&depth0.selected,{
hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</option>\n                        "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;return buffer+='<div class="preview-overlay tao-scope overlay preview-',
(helper=helpers.previewType)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.previewType,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+' item-no-print"\n     style="display:none">\n    <div class="preview-container-outer">\n        <form class="preview-utility-bar plain">\n            <div class="preview-utility-bar-inner grid-row">\n\n                <div class="col-4">\n                    <input type="hidden" value="" data-value="" class="standard-device-selector preview-device-selector" data-target="standard">\n                    <select class="preview-type-selector">\n                        ',
stack1=helpers.each.call(depth0,depth0&&depth0.previewTypes,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    </select>\n                    ",stack1=helpers["if"].call(depth0,depth0&&depth0.hasThemes,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                </div>\n                <div class="col-6 standard-only device-type-and-orientation"></div>\n                <div class="col-6 desktop-only device-type-and-orientation">\n                    <select class="desktop-device-selector preview-device-selector" data-target="desktop">\n                        ',
stack1=helpers.each.call(depth0,depth0&&depth0.desktopDevices,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </select>\n                </div>\n                <div class="col-6 mobile-only device-type-and-orientation">\n                    <select class="mobile-device-selector preview-device-selector" data-target="mobile">\n                        ',stack1=helpers.each.call(depth0,depth0&&depth0.mobileDevices,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </select>\n                    <select tabindex="-1" class="mobile-orientation-selector orientation-selector"\n                            data-target="mobile">\n                        <option value="landscape">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Landscape",options):helperMissing.call(depth0,"__","Landscape",options)))+'</option>\n                        <option value="portrait">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Portrait",options):helperMissing.call(depth0,"__","Portrait",options)))+'</option>\n                    </select>\n                </div>\n                <div class="col-2">\n                    <span class="btn-info small preview-closer rgt">\n                        '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Close",options):helperMissing.call(depth0,"__","Close",options)))+'\n                        <span class="icon-close r"></span>\n                    </span>\n                </div>\n            </div>\n            <div class="preview-message-box">\n                <div class="feedback-info small">\n                    <span class="icon-info"></span>\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"This preview may be scaled to fit your screen. The final rendering may differ.",options):helperMissing.call(depth0,"__","This preview may be scaled to fit your screen. The final rendering may differ.",options)))+'\n                    <a href="#">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Don’t show this again!",options):helperMissing.call(depth0,"__","Don’t show this again!",options)))+'</a>\n                    <span title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Remove this message",options):helperMissing.call(depth0,"__","Remove this message",options)))+'" class="icon-close close-trigger"></span>\n                </div>\n            </div>\n        </form>\n        <div class="preview-canvas">\n            <div class="preview-scale-container">\n                <div class="',
(helper=helpers.previewType)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.previewType,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"-preview-frame preview-outer-frame ",(helper=helpers.previewType)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.previewType,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'-preview-landscape">\n                    <div class="',(helper=helpers.previewType)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.previewType,stack1=typeof helper===functionType?helper.call(depth0,{
hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'-preview-container preview-container">\n                        <div class="preview-item-container"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n    <div id="preview-console">\n        <span class="icon-close preview-console-closer" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Close console",options):helperMissing.call(depth0,"__","Close console",options)))+'"></span>\n        <div class="preview-console-header grid-row clearfix">\n            <ul class="col-10 plain action-bar extra-button-action-bar horizontal-action-bar">\n            </ul>\n            <ul class="col-2 plain action-bar console-button-action-bar horizontal-action-bar">\n                <li class="small btn-info action action-button rgt" id="preview-submit-button">\n                    <a class="li-inner" href="#">\n                        <span class="label">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Submit",options):helperMissing.call(depth0,"__","Submit",options)))+'</span>\n                    </a>\n                </li>\n            </ul>\n        </div>\n        <div class="preview-console-body clear">\n            <ul></ul>\n        </div>\n    </div>\n</div>\n\n\n\n'})}),define("css!taoItemsCss/preview",[],function(){}),define("taoItems/preview/preview",["jquery","lodash","i18n","util/strPad","core/promise","json!taoItems/preview/resources/device-list.json","tpl!taoItems/preview/tpl/preview","ui/themes","ui/themeLoader","ui/modal","select2","jquery.cookie","css!taoItemsCss/preview"],function($,_,__,strPad,Promise,deviceList,previewTpl,themeHandler,themeLoader){
"use strict";function _setupScreenSize(){screenSize={width:$(".preview-overlay").innerWidth(),height:$(".preview-overlay").innerHeight()}}var overlay,container,typeDependant,$feedbackBox,$console,previewContainerMaxWidth,itemUri,orientation="landscape",previewType="standard",previewTypes={desktop:__("Desktop preview"),mobile:__("Mobile preview"),standard:__("Actual size")},themeObj=themeHandler.get("items")||{},$doc=$(document),$window=$(window),$body=$(document.body),screenSize={width:$window.innerWidth(),height:$window.innerHeight()},sizeSettings={width:0,height:0},scaleFactor=1,winScrollObj={x:0,y:0},_getDeviceSelectorData=function(type){var devices="mobile"===type?deviceList.tablets:deviceList.screens,options=[];
return _.forEach(devices,function(value){options.push({value:value.label,label:value.label,dataValue:[value.width,value.height].join(","),selected:previewType===value.label})}),options},_setupTypeDependantElements=function(){typeDependant=overlay.add(overlay.find(".preview-scale-container").find('[class*="'+previewType+'"]'))},_setPreviewType=function(newType){if(newType!==previewType){var re=new RegExp(previewType,"g");typeDependant.each(function(i,el){el.className=el.className.replace(re,newType)}),previewType=newType}},_setOrientation=function(newOrientation){if(newOrientation!==orientation){var re=new RegExp(orientation,"g"),previewFrame=$(".preview-outer-frame")[0];
previewFrame.className=previewFrame.className.replace(re,newOrientation),orientation=newOrientation}},_scale=function(){_computeScaleFactor();var $scaleContainer=$(".preview-scale-container"),_scaleFactor="standard"===previewType?1:scaleFactor,containerScaledWidth=$scaleContainer.width()*_scaleFactor,left=(screenSize.width-containerScaledWidth)/2;$scaleContainer.css({left:left>0?left:0,"-webkit-transform":"scale("+_scaleFactor+","+_scaleFactor+")","-ms-transform":"scale("+_scaleFactor+","+_scaleFactor+")",transform:"scale("+_scaleFactor+","+_scaleFactor+")","-webkit-transform-origin":"0 0","-ms-transform-origin":"0 0","transform-origin":"0 0"})},_positionPreview=function(){
var topBarHeight=$(".preview-utility-bar").outerHeight();overlay[0].style.top=topBarHeight+"px",overlay[0].style.maxHeight="calc(100vh - "+topBarHeight+"px - "+$console.outerHeight()+"px )"},_computeScaleFactor=function(){var scaleValues={x:1,y:1},requiredSize={width:sizeSettings.width+150,height:sizeSettings.height+275};requiredSize.width>screenSize.width&&(scaleValues.x=screenSize.width/requiredSize.width),requiredSize.height>screenSize.height&&(scaleValues.y=screenSize.height/requiredSize.height),scaleFactor=Math.min(scaleValues.x,scaleValues.y)},_setupDeviceSelectors=function(){var previewDeviceSelectors=overlay.find(".preview-device-selector");previewDeviceSelectors.on("change",function(){
for(var elem=$(this),option="select"===this.nodeName.toLowerCase()?this.options[this.selectedIndex]:this,type=elem.data("target"),val=$(option).data("value").split(","),i=val.length,container=overlay.find("."+type+"-preview-container");i--;)val[i]=parseFloat(val[i]);return sizeSettings="mobile"===type&&"portrait"===orientation?{width:val[1],height:val[0]}:{width:val[0],height:val[1]},sizeSettings.width===container.width()&&sizeSettings.height===container.height()?!1:(_setPreviewType(type),container.css(sizeSettings),_scale(),void _adaptFrameSize())}),previewDeviceSelectors.each(function(){"select"===this.nodeName.toLowerCase()&&$(this).select2({minimumResultsForSearch:-1
})})},_setupOrientationSelectors=function(){$("select.orientation-selector").on("change",function(){var type=$(this).data("target"),previewFrame=$("."+type+"-preview-frame"),container=previewFrame.find("."+type+"-preview-container"),newOrientation=$(this).val();return newOrientation===orientation?!1:(sizeSettings={height:container.width(),width:container.height()},container.css(sizeSettings),_setOrientation(newOrientation),_scale(),void _adaptFrameSize())}).select2({minimumResultsForSearch:-1})},_setupClosers=function(){var $closer=overlay.find(".preview-closer"),$feedbackCloser=$feedbackBox.find(".close-trigger"),$hideForever=$feedbackBox.find("a"),$iframe=$("#preview-iframe");
$closer.on("click",function(){$doc.trigger("itemunload.preview"),window.scrollTo(winScrollObj.x,winScrollObj.y),overlay.hide(),$body.removeClass("preview-mode"),$iframe.off("load").attr("src","about:blank")}),$doc.keyup(function(e){27===e.keyCode&&$closer.trigger("click")}),$feedbackCloser.on("click",function(){$feedbackBox.hide(),$body.addClass("no-preview-feedback"),_positionPreview(),_scale()}),$hideForever.on("click",function(e){e.preventDefault(),$.cookie("hidePreviewFeedback",!0,{expires:1e3,path:"/"}),$feedbackCloser.trigger("click")})},_getThemes=function(){var activeTheme=themeLoader(themeObj).getActiveTheme(),options=[];return _(themeObj.available).forEach(function(data){
options.push({value:data.id,label:data.name,selected:data.id===activeTheme})}),options},_getPreviewTypes=function(){var options=[];return _(previewTypes).forEach(function(_previewLabel,_previewType){options.push({value:_previewType,label:_previewLabel,selected:previewType===_previewType})}),options},_setupViewSelector=function(){$("select.preview-type-selector").on("change",function(){var _previewType=$(this),value=_previewType.val();_setPreviewType(value),$("."+value+"-device-selector").trigger("change")}).select2({minimumResultsForSearch:-1})},_setupThemeSelector=function(){$("select.preview-theme-selector").on("change",function(){var iframe=document.getElementById("preview-container"),iframeDoc=iframe.contentWindow||iframe.contentDocument;
iframeDoc.$(".qti-item").trigger("themechange",[$(this).val()])}).select2({minimumResultsForSearch:-1})},_adaptFrameSize=function(){var $previewContainer=$(".preview-container"),$iframe=function(){var _iframe=$previewContainer.find("iframe");return _iframe.height(""),_iframe}(),contentHeight=$iframe.contents().outerHeight(),containerHeight=$previewContainer.innerHeight();"standard"!==previewType?containerHeight>contentHeight&&(contentHeight=containerHeight):$previewContainer.height(contentHeight+10),$iframe.height(contentHeight)},_updateStandardPreviewSize=function(height){var $selector=$(".standard-device-selector"),values=($selector.val()?$selector.val().split(","):"")||[$window.width().toString()],valueStr=values.join(",");
values[1]=height||values[1]||"1200",$selector.val(valueStr).data("value",valueStr)},_initConsole=function(){var $body=$console.find(".preview-console-body"),$listing=$body.find("ul"),$closer=$console.find(".preview-console-closer");$console.off("updateConsole").on("updateConsole",function(event,type,message){var timer=new Date,logTime=[strPad(timer.getHours(),2,"0","STR_PAD_LEFT"),strPad(timer.getMinutes(),2,"0","STR_PAD_LEFT"),strPad(timer.getSeconds(),2,"0","STR_PAD_LEFT")].join(":"),msgStr='<span class="log-time">'+strPad(logTime,12," ")+'</span> <span class="log-type">'+strPad(type,18," ")+'</span> <span class="log-message">'+strPad(message,18," ")+"</span>";
$listing.append("<li><pre>"+msgStr+"</pre></li>"),$body.is(":visible")?$listing.scrollTop(1e4):$body.slideDown("slow",function(){$closer.show(),$listing.scrollTop(1e4)})}),$closer.on("click",function(){$body.slideUp("slow",function(){$closer.hide()})})},show=function(){return new Promise(function(resolve,reject){$.ajax({url:itemUri,dataType:"html"}).done(function(data){winScrollObj={x:window.scrollX,y:window.scrollY},window.scrollTo(0,0),$body.addClass("preview-mode"),overlay[0].style.display="block",overlay.find("select:visible").not(".preview-theme-selector").trigger("change"),_scale(),_positionPreview(),$(".preview-item-container").html(data),resolve()}).fail(function(xhr){
reject(new Error(__("Unable to render the item from %s : %s %s",itemUri,xhr.status,xhr.statusText)))})})},init=function(_itemUri){if(!_itemUri||0===_itemUri.length)throw new TypeError("Wrong URI");return $(".preview-overlay").remove(),container=null,overlay=$(previewTpl({mobileDevices:_getDeviceSelectorData("mobile"),desktopDevices:_getDeviceSelectorData("desktop"),previewTypes:_getPreviewTypes(),previewType:previewType,themes:_getThemes(),hasThemes:_.size(themeObj.available)>1})),$body.append(overlay),previewContainerMaxWidth=parseInt($(".preview-container").css("max-width"),10),$feedbackBox=overlay.find(".preview-message-box"),$.cookie("hidePreviewFeedback")&&($feedbackBox.hide(),
$body.addClass("no-preview-feedback")),$console=overlay.find("#preview-console"),_initConsole(),_updateStandardPreviewSize(),_setupTypeDependantElements(),_setupDeviceSelectors(),_setupOrientationSelectors(),_setupViewSelector(),_setupThemeSelector(),_setupClosers(),_setupScreenSize(),_computeScaleFactor(),_setPreviewType(previewType),_setOrientation(orientation),$window.on("resize orientationchange",function(){_setupScreenSize(),_updateStandardPreviewSize(),_computeScaleFactor(),_scale()}),itemUri=_itemUri,overlay};return{init:init,show:show}}),define("taoOutcomeUi/controller/viewResult",["module","jquery","i18n","helpers","layout/section","taoItems/preview/preview","jquery.fileDownload"],function(module,$,__,helpers,section,preview){
"use strict";var viewResultController={start:function(){var conf=module.config(),$container=$("#view-result"),$resultFilterField=$(".result-filter",$container),$classFilterField=$('[name="class-filter"]',$container),classFilter=JSON.parse(conf.filterTypes)||[];$resultFilterField.select2({minimumResultsForSearch:-1}).select2("val",conf.filterSubmission||"all");for(var i in classFilter)$('[value="'+classFilter[i]+'"]').prop("checked","checked");$(".result-filter-btn",$container).click(function(e){classFilter=[""],$classFilterField.each(function(){$(this).prop("checked")&&classFilter.push($(this).val())}),section.loadContentBlock(helpers._url("viewResult","Results","taoOutcomeUi"),{
id:conf.id,classUri:conf.classUri,filterSubmission:$resultFilterField.select2("val"),filterTypes:classFilter})}),$(".download",$container).on("click",function(e){var variableUri=$(this).val();$.fileDownload(helpers._url("getFile","Results","taoOutcomeUi"),{preparingMessageHtml:__("We are preparing your report, please wait..."),failMessageHtml:__("There was a problem generating your report, please try again."),httpMethod:"POST",data:{variableUri:variableUri,deliveryUri:conf.classUri}})}),$(".preview",$container).on("click",function(e){e.preventDefault(),window.scrollTo(0,0),preview.init(helpers._url("forwardMe","ItemPreview","taoItems",{uri:$(this).data("uri")
})),preview.show()})}};return viewResultController}),function(c){var d=document,a="appendChild",i="styleSheet",s=d.createElement("style");s.type="text/css",d.getElementsByTagName("head")[0][a](s),s[i]?s[i].cssText=c:s[a](d.createTextNode(c))}('body.preview-mode{height:100vh !important;max-height:100vh;overflow:hidden}body.no-preview-feedback .preview-overlay .preview-container{background:white;overflow:auto}body.no-preview-feedback .preview-overlay .preview-container .preview-item-container,body.no-preview-feedback .preview-overlay .preview-container #preview-container{min-height:calc(100vh - 82px) !important}.preview-overlay{display:none;width:100%;height:100%;z-index:19995;position:absolute;left:0;background:rgba(0,0,0,0.7)}.preview-overlay.preview-desktop{overflow:visible}.preview-overlay.preview-desktop .mobile-only,.preview-overlay.preview-desktop .standard-only{display:none !important}.preview-overlay.preview-mobile{overflow:visible}.preview-overlay.preview-mobile .desktop-only,.preview-overlay.preview-mobile .standard-only{display:none !important}.preview-overlay.preview-standard{overflow:visible}.preview-overlay.preview-standard .desktop-only,.preview-overlay.preview-standard .mobile-only{display:none !important}.preview-overlay .preview-scale-container{position:relative;float:left}.preview-overlay .preview-container{background:white;overflow:auto}.preview-overlay .preview-container .preview-item-container,.preview-overlay .preview-container #preview-container{min-height:calc(100vh - 130px) !important}.preview-overlay .preview-container-outer{display:table;padding:0;width:100%;height:100%}.preview-overlay .preview-utility-bar{background:#f3f1ef;border-bottom:1px solid #8d949e;margin-bottom:20px;z-index:9996;overflow:hidden;padding:10px;position:fixed;top:0;left:0;width:100%}.preview-overlay .preview-utility-bar .preview-heading{min-width:140px}.preview-overlay .preview-utility-bar .device-type-and-orientation{min-width:340px}.preview-overlay .preview-utility-bar-inner{max-width:1024px;width:100%;margin:auto}.preview-overlay .preview-utility-bar-inner h1{font-size:18px;font-size:1.8rem;text-shadow:1px 1px 0px #eee}.preview-overlay .preview-utility-bar-inner .icon-info{top:7px;font-size:15px;font-size:1.5rem}.preview-overlay .preview-utility-bar-inner li{margin-left:10px}.preview-overlay .preview-utility-bar-inner .btn-info{margin-top:1px}.preview-overlay .preview-utility-bar-inner .mobile-device-selector{width:200px}.preview-overlay .preview-utility-bar-inner .preview-type-selector{width:140px}.preview-overlay .preview-utility-bar-inner .preview-theme-selector{width:140px}.preview-overlay .preview-utility-bar-inner .orientation-selector,.preview-overlay .preview-utility-bar-inner .desktop-device-selector{width:130px}.preview-overlay .preview-utility-bar-inner [class*=" col-"],.preview-overlay .preview-utility-bar-inner [class^="col-"]{margin-bottom:0 !important}.preview-overlay #preview-console{margin:0;padding:0;border:none;z-index:auto;background:#266d9c;position:fixed;bottom:0;left:0;width:100%}.preview-overlay #preview-console .preview-console-closer{position:absolute;right:10px;top:10px;cursor:pointer;color:rgba(255,255,255,0.9);display:none;text-shadow:none}.preview-overlay #preview-console .preview-console-closer:hover{color:white}.preview-overlay #preview-console .preview-console-header{max-width:1024px;width:100%;margin:auto;padding:0}.preview-overlay #preview-console .preview-console-header [class*=" col-"],.preview-overlay #preview-console .preview-console-header [class^="col-"]{margin-bottom:0 !important}.preview-overlay #preview-console .extra-button-action-bar{overflow:visible}.preview-overlay #preview-console .extra-button-action-bar li{margin:0 5px}.preview-overlay #preview-console .extra-button-action-bar li.btn-info{border-color:rgba(255,255,255,0.3)}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group{border:none !important;overflow:visible;padding:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a{float:left;margin:0 2px;padding:0 15px;border:1px solid rgba(255,255,255,0.3);border-radius:0px;display:inline-block;height:inherit}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a:first-of-type{border-top-left-radius:3px;border-bottom-left-radius:3px;margin-left:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a:last-of-type{border-top-right-radius:3px;border-bottom-right-radius:3px;margin-right:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a:hover,.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a.active{border-color:rgba(255,255,255,0.8)}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a .no-label{padding-right:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info:hover,.preview-overlay #preview-console .extra-button-action-bar li.btn-info.active{border-color:rgba(255,255,255,0.8)}.preview-overlay #preview-console .extra-button-action-bar.horizontal-action-bar.bottom-action-bar{overflow:visible}.preview-overlay #preview-console .extra-button-action-bar.horizontal-action-bar.bottom-action-bar .action{line-height:1.6}.preview-overlay #preview-console .preview-console-body{display:none}.preview-overlay #preview-console .preview-console-body ul{padding:5px;margin:0;height:300px;overflow:auto;background:#2b2b2b;font-family:Consolas,"Andale Mono WT","Andale Mono","Lucida Console","Lucida Sans Typewriter","DejaVu Sans Mono","Bitstream Vera Sans Mono","Liberation Mono","Nimbus Mono L",Monaco,"Courier New",Courier,monospace;color:#fff}.preview-overlay #preview-console .preview-console-body ul .log-time{color:#999}.preview-overlay #preview-console .preview-console-body ul .log-type{color:#eee}.preview-overlay #preview-console .preview-console-body ul .log-message{color:#69f}.preview-overlay #preview-console .preview-console-body ul pre{margin:0}.preview-overlay .preview-message-box .feedback-info{margin:10px auto 0px;width:800px}.preview-overlay .preview-message-box a{float:right;padding-right:10px}.preview-overlay .desktop-preview-container{width:1024px;background:#fff url(data:image/gif;base64,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) no-repeat center 150px}.preview-overlay .desktop-preview-frame{position:relative;border:3px #aaa solid;border-radius:5px;background:#5a5a5a;background:linear-gradient(135deg, #5a5a5a 0%, #565656 7%, #444 15%, #141414 30%);box-shadow:5px 5px 10px 0 rgba(0,0,0,0.7)}.preview-overlay .desktop-preview-frame.desktop-preview-landscape{padding:30px 30px}.preview-overlay .desktop-preview-frame.desktop-preview-landscape .desktop-device-toolbar{padding-right:30px}.preview-overlay .desktop-preview-frame.desktop-preview-portrait{padding:30px 30px}.preview-overlay .desktop-preview-frame.desktop-preview-portrait .desktop-device-toolbar{padding-right:30px}.preview-overlay .desktop-preview-item-container{min-height:500px;-webkit-box-shadow:0px 0px 8px #b7b1ac;-moz-box-shadow:0px 0px 8px #b7b1ac;box-shadow:0px 0px 8px #b7b1ac}.preview-overlay .preview-canvas{display:table-cell;text-align:center}.preview-overlay .preview-canvas *{text-align:left}.preview-overlay .preview-outer-frame{position:relative;display:inline-block}.preview-overlay .mobile-preview-container{-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box;position:relative}.preview-overlay .mobile-preview-item-container{height:100%}.preview-overlay .mobile-preview-frame{position:relative;border:3px #aaa ridge;border-radius:25px;background:#5a5a5a;background:linear-gradient(135deg, #5a5a5a 0%, #565656 7%, #444 15%, #141414 30%);box-shadow:5px 5px 10px 0 rgba(0,0,0,0.7)}.preview-overlay .mobile-preview-frame.mobile-preview-landscape{padding:40px 40px}.preview-overlay .mobile-preview-frame.mobile-preview-landscape .mobile-device-toolbar{padding-right:40px}.preview-overlay .mobile-preview-frame.mobile-preview-portrait{padding:40px 40px}.preview-overlay .mobile-preview-frame.mobile-preview-portrait .mobile-device-toolbar{padding-right:40px}.preview-overlay .mobile-preview-container{background:white;border-radius:3px;border:2px solid;border-color:#444 #999 #999 #444}.preview-overlay .standard-preview-frame{box-shadow:0px 0px 8px rgba(0,0,0,0.7)}\n/*# sourceMappingURL=preview.css.map */\n');
//# sourceMappingURL=controllers.min.js.map